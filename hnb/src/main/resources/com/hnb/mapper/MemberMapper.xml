<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hnb.mapper.MemberMapper">
	<cache/>
	<insert id="insert" parameterType="com.hnb.member.MemberVO">
		INSERT INTO MEMBER VALUES
		(#{id}, #{password}, #{name}, #{birth}, #{gender}, #{phone}, #{addr}, #{email}, sysdate)
	</insert>
	
	<select id="selectAll" parameterType="com.hnb.global.Command" resultType="com.hnb.member.MemberVO">
		SELECT
		  ID AS id,
		  PASSWORD AS password,
		  NAME AS name,
		  BIRTH AS birth,
		  ADDR AS addr,
		  GENDER AS gender,
		  EMAIL AS email,
		  PHONE AS phone,
		  REGDATE AS regdate
		FROM (SELECT ROWNUM AS seq, m.* FROM MEMBER m) <!-- 현재 테이블에는 seq가 없으므로 번호를 부여함 -->
		WHERE seq BETWEEN #{start} AND #{end}
	</select>  
	
	<select id="selectOneBy" parameterType="string" resultType="com.hnb.member.MemberVO">
		SELECT
		  ID AS id,
		  PASSWORD AS password,
		  NAME AS name,
		  BIRTH AS birth,
		  ADDR AS addr,
		  GENDER AS gender,
		  EMAIL AS email,
		  PHONE AS phone,
		  REGDATE AS regdate
		FROM MEMBER WHERE ID = #{id}
	</select>
	
	<select id="selectSomeBy" parameterType="com.hnb.global.Command" resultType="com.hnb.member.MemberVO">
		SELECT
		  ID AS id,
		  PASSWORD AS password,
		  NAME AS name,
		  BIRTH AS birth,
		  ADDR AS addr,
		  GENDER AS gender,
		  EMAIL AS email,
		  PHONE AS phone,
		  REGDATE AS regdate
		FROM (SELECT ROWNUM AS seq, m.* FROM (
			SELECT * FROM MEMBER
			WHERE ${column} LIKE '%' || #{keyword} || '%' <!-- 이름검색시 '%홍%' -->
		) m)
		WHERE seq BETWEEN #{start} AND #{end}

	</select>
	<!-- 칼럼이름은 jsp의 내용을 가져와야 한다. -->
	<select id="count" resultType="int">
		SELECT COUNT(*) AS COUNT FROM MEMBER
	</select>
	
	<select id="countSomeBy" parameterType="com.hnb.global.Command" resultType="int">
		SELECT COUNT(*) AS COUNT FROM MEMBER
		WHERE ${column} LIKE '%' || #{keyword} || '%' <!-- 이름검색시 '%홍%' -->
		

	</select>
	
	<update id="update" parameterType="com.hnb.member.MemberVO">
		UPDATE MEMBER SET PASSWORD = #{password}, ADDR = #{addr}, PHONE = #{phone}, EMAIL = #{email} WHERE ID = #{id}
	</update>
	
	<delete id="delete" parameterType="string">
		DELETE FROM MEMBER WHERE ID = #{id}
	</delete>
</mapper>